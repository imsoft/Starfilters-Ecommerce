---
// Componente Astro wrapper para PasswordInput
export interface Props {
  id: string;
  name: string;
  required?: boolean;
  autocomplete?: string;
  placeholder?: string;
  class?: string;
}

const { id, name, required, autocomplete, placeholder, class: className } = Astro.props;
---

<div class="relative">
  <input
    id={id}
    type="password"
    name={name}
    required={required}
    autocomplete={autocomplete}
    placeholder={placeholder}
    class={`block w-full rounded-md bg-background px-3 py-1.5 pr-10 text-base text-foreground outline-1 -outline-offset-1 outline-border placeholder:text-muted-foreground focus:outline-2 focus:-outline-offset-2 focus:outline-primary sm:text-sm/6 ${className || ''}`}
  />
  <button
    type="button"
    class="absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground hover:text-foreground transition-colors"
    onclick="togglePassword(this)"
    aria-label="Mostrar contrase침a"
  >
    <svg
      class="h-5 w-5 eye-open"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      stroke-width="2"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"
      ></path>
      <circle
        cx="12"
        cy="12"
        r="3"
        stroke-linecap="round"
        stroke-linejoin="round"
      ></circle>
    </svg>
    <svg
      class="h-5 w-5 eye-closed hidden"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
      stroke-width="2"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M9.88 9.88a3 3 0 1 0 4.24 4.24"
      ></path>
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"
      ></path>
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"
      ></path>
      <line
        stroke-linecap="round"
        stroke-linejoin="round"
        x1="2"
        y1="2"
        x2="22"
        y2="22"
      ></line>
    </svg>
  </button>
</div>

<script>
  function togglePassword(button: HTMLButtonElement) {
    const input = button.parentElement?.querySelector('input') as HTMLInputElement;
    const eyeOpen = button.querySelector('.eye-open') as HTMLElement;
    const eyeClosed = button.querySelector('.eye-closed') as HTMLElement;
    
    if (input.type === 'password') {
      input.type = 'text';
      eyeOpen.classList.add('hidden');
      eyeClosed.classList.remove('hidden');
      button.setAttribute('aria-label', 'Ocultar contrase침a');
    } else {
      input.type = 'password';
      eyeOpen.classList.remove('hidden');
      eyeClosed.classList.add('hidden');
      button.setAttribute('aria-label', 'Mostrar contrase침a');
    }
  }

  // Hacer la funci칩n global para que funcione con onclick
  (window as any).togglePassword = togglePassword;
</script>
